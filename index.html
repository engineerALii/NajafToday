<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة النجف اليوم | إشراقة التاريخ</title>
    <meta name="description" content="اكتشف وجه النجف الحضاري والروحي بتصميم عصري.">

    <!-- أيقونات الموقع (Favicons) -->
    <link rel="icon" type="image/png" href="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <link rel="apple-touch-icon" href="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <link rel="apple-touch-icon" sizes="76x76" href="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <link rel="apple-touch-icon" sizes="120x120" href="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <link rel="apple-touch-icon" sizes="152x152" href="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <link rel="icon" type="image/png" sizes="192x192" href="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <link rel="icon" type="image/png" sizes="32x32" href="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <link rel="icon" type="image/png" sizes="96x96" href="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <link rel="icon" type="image/png" sizes="16x16" href="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj">
    <meta name="theme-color" content="#ffffff">
    
    <!-- الخطوط: كايرو (هندسي عصري) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- الأيقونات -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        /* ========================================
           1. المتغيرات (Themes)
           ========================================
        */
        :root {
            --primary: #1e88e5;
            --primary-dark: #1565c0;
            --accent: #ffb300;
            
            --bg-body: #ffffff;
            --bg-light: #f8f9fa;
            --bg-header: rgba(255, 255, 255, 0.9);
            --bg-card: #ffffff;
            
            --text-main: #2d3436;
            --text-muted: #636e72;
            --text-inverse: #ffffff;
            
            --border-color: #f0f0f0;
            
            --font-main: 'Cairo', sans-serif;
            
            --shadow-card: 0 10px 30px rgba(0,0,0,0.05);
            --shadow-hover: 0 20px 40px rgba(0,0,0,0.1);
            
            --radius: 16px;
        }

        [data-theme="dark"] {
            --primary: #64b5f6;
            --primary-dark: #42a5f5;
            --accent: #ffca28;
            --bg-body: #121212;
            --bg-light: #1e1e1e;
            --bg-header: rgba(18, 18, 18, 0.9);
            --bg-card: #1e1e1e;
            --text-main: #e0e0e0;
            --text-muted: #a0a0a0;
            --text-inverse: #121212;
            --border-color: #333333;
            --shadow-card: 0 10px 30px rgba(0,0,0,0.3);
            --shadow-hover: 0 20px 40px rgba(0,0,0,0.5);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: var(--font-main);
            overflow-x: hidden;
            line-height: 1.7;
            transition: background-color 0.3s, color 0.3s;
        }

        h1, h2, h3, h4 { font-weight: 800; color: var(--text-main); line-height: 1.3; }
        a { text-decoration: none; color: inherit; transition: 0.3s; }
        ul { list-style: none; }
        img { width: 100%; height: auto; display: block; object-fit: cover; }
        button { cursor: pointer; font-family: var(--font-main); }

        /* ========================================
           2. الهيدر
           ========================================
        */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 15px 5%;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-header);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border-color);
            transition: 0.3s;
        }

        .logo {
            font-size: 1.3rem;
            font-weight: 900;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo img {
            width: 40px;
            height: 40px;
            border-radius: 8px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-links {
            display: flex;
            gap: 25px;
        }

        .nav-links a {
            color: var(--text-main);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .nav-links a:hover { color: var(--primary); }

        .theme-btn {
            background: var(--bg-light);
            color: var(--text-main);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            transition: 0.3s;
        }
        
        .theme-btn:hover { background: var(--border-color); }

        .btn-header {
            background: var(--primary);
            color: #fff;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.9rem;
            border: none;
        }

        /* زر القائمة للموبايل */
        .menu-toggle {
            display: none;
            font-size: 1.8rem;
            color: var(--text-main);
            cursor: pointer;
            margin-right: 10px;
        }

        /* ========================================
           3. الهيرو (Fixed Layout)
           ========================================
        */
        .hero {
            position: relative;
            width: 100%;
            margin-top: 72px; /* ارتفاع الهيدر بالضبط */
            display: flex;
            flex-direction: column;
            background: var(--bg-body);
        }

        .hero-video-container {
            width: 100%;
            height: 85vh; /* ارتفاع مناسب للفيديو */
            position: relative;
            background: #000;
            overflow: hidden;
        }

        .hero-video-container video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        /* زر كتم الصوت العائم */
        .volume-toggle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            color: var(--text-main);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: var(--shadow-card);
        }
        
        .volume-toggle:hover {
            background: var(--text-main);
            color: var(--text-inverse);
            transform: scale(1.05);
        }

        .hero-content-block {
            text-align: center;
            padding: 60px 20px;
            background: var(--bg-body);
            max-width: 900px;
            margin: 0 auto;
        }

        .hero-content-block h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin-bottom: 15px;
            color: var(--text-main);
        }

        .hero-content-block p {
            font-size: 1.1rem;
            color: var(--text-muted);
            margin-bottom: 30px;
            font-weight: 400;
        }

        .hero-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .hero-cta {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: var(--primary);
            color: #fff;
            padding: 15px 40px;
            border-radius: 50px;
            font-weight: 700;
            border: none;
            transition: 0.3s;
            box-shadow: 0 10px 20px rgba(30, 136, 229, 0.2);
        }

        .hero-cta:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
        }

        /* ========================================
           4. الأقسام العامة
           ========================================
        */
        section { padding: 80px 5%; }
        .bg-alt { background-color: var(--bg-light); }

        .section-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .section-header h2 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        /* ========================================
           5. عن المدينة
           ========================================
        */
        .about-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
            align-items: center;
        }

        .about-media {
            position: relative;
        }

        .about-media img {
            border-radius: 20px;
            box-shadow: var(--shadow-card);
        }

        .badge-info {
            position: absolute;
            bottom: -20px;
            left: -20px;
            background: var(--bg-card);
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-hover);
            display: flex;
            align-items: center;
            gap: 15px;
            border: 1px solid var(--border-color);
        }

        .badge-info i { font-size: 2rem; color: var(--accent); }

        .tags-container {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .tag-pill {
            background: var(--bg-light);
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--primary);
            border: 1px solid var(--border-color);
        }

        /* ========================================
           6. المعرض والمميزات
           ========================================
        */
        .grid-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
        }

        .card {
            background: var(--bg-card);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow-card);
            border: 1px solid var(--border-color);
            transition: 0.4s;
            position: relative;
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary);
        }

        .gallery-card { height: 320px; cursor: pointer; }
        
        .gallery-card img {
            width: 100%;
            height: 100%;
            transition: 0.5s;
        }
        
        .gallery-card:hover img { transform: scale(1.05); }

        .gallery-overlay {
            position: absolute;
            bottom: 0; left: 0; right: 0;
            padding: 20px;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            color: #fff;
            opacity: 0;
            transition: 0.3s;
            transform: translateY(10px);
        }

        .gallery-card:hover .gallery-overlay {
            opacity: 1;
            transform: translateY(0);
        }

        .feature-card {
            padding: 30px;
            text-align: center;
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: var(--bg-light);
            color: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin: 0 auto 20px;
        }

        /* ========================================
           7. التواصل والفوتر
           ========================================
        */
        .contact-box {
            background: var(--bg-card);
            padding: 50px;
            border-radius: 20px;
            box-shadow: var(--shadow-card);
            max-width: 800px;
            margin: 0 auto;
            border: 1px solid var(--border-color);
        }

        .input-line {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            background: var(--bg-light);
            border: 1px solid transparent;
            border-radius: 10px;
            color: var(--text-main);
            font-family: var(--font-main);
        }

        .input-line:focus {
            outline: none;
            background: var(--bg-card);
            border-color: var(--primary);
        }

        footer {
            background: var(--bg-light);
            padding: 40px;
            text-align: center;
            font-size: 0.9rem;
            border-top: 1px solid var(--border-color);
        }

        /* ========================================
           8. أدوات الأدمن والمودال
           ========================================
        */
        .admin-controls {
            position: absolute;
            top: 10px;
            left: 10px;
            display: none;
            gap: 5px;
            z-index: 5;
        }

        body.is-admin .admin-controls, 
        body.is-admin .admin-bar { display: flex !important; }

        .btn-ctrl {
            width: 30px; height: 30px;
            border-radius: 50%;
            border: none;
            color: #fff;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
        }
        .btn-del { background: #ff4757; }
        .btn-edit { background: #2ed573; }

        .admin-bar {
            display: none;
            justify-content: center;
            margin-bottom: 30px;
        }

        /* Modals */
        .modal-overlay {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            display: none;
            justify-content: center; align-items: center;
            backdrop-filter: blur(5px);
        }
        .modal-overlay.active { display: flex; }

        .modal-content {
            background: var(--bg-card);
            padding: 30px;
            border-radius: 20px;
            width: 90%; max-width: 450px;
            box-shadow: var(--shadow-hover);
            color: var(--text-main);
        }

        /* تنسيق جديد لاسم المطور */
        .developer-badge {
            margin-top: 15px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-card);
            padding: 10px 25px;
            border-radius: 50px;
            border: 2px solid var(--primary); /* إطار بلون الثيم */
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            font-size: 1.1rem; /* تكبير الخط */
            font-weight: 700;
            color: var(--text-main);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .developer-badge:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(30, 136, 229, 0.2);
        }

        .developer-badge a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 800; /* خط عريض للاسم */
        }

        .developer-badge a:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }

        /* Responsive & Mobile Menu */
        @media (max-width: 992px) {
            .nav-links {
                position: absolute;
                top: 70px;
                left: 0;
                width: 100%;
                background: var(--bg-header);
                backdrop-filter: blur(15px);
                flex-direction: column;
                padding: 20px;
                gap: 15px;
                border-bottom: 1px solid var(--border-color);
                box-shadow: 0 5px 15px rgba(0,0,0,0.05);
                display: none; /* Hidden by default */
                text-align: center;
            }
            .nav-links.active { display: flex; }
            
            .menu-toggle { display: block !important; }
            .btn-header { display: none; } /* Hide 'Contact' btn in header on small screens */
            
            /* Improve Hero on Tablet */
            .hero-video-container { height: 50vh; }
            .hero-content-block { padding: 40px 20px; }
            .hero-content-block h1 { font-size: 2.2rem; }
        }

        @media (max-width: 768px) {
            .about-grid { grid-template-columns: 1fr; }
            .badge-info { position: static; margin-top: 15px; display: inline-flex; }
            .contact-box { padding: 30px; }
            .developer-badge { font-size: 0.95rem; padding: 8px 20px; }

            /* تصغير الفيديو في الموبايل ليظهر بالكامل (نسبة 16:9) */
            .hero-video-container {
                height: auto;
                aspect-ratio: 16/9;
            }

            /* === تحديث الشعار للموبايل === */
            .logo span {
                display: none; /* إخفاء النص */
            }
            
            .logo img {
                width: 70px; /* تكبير الشعار */
                height: 70px;
                border-radius: 12px;
            }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header id="navbar">
        <a href="#" class="logo">
            <img src="https://dl.dropboxusercontent.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=0v9pv0qj" alt="Logo">
            <span>النجف اليوم</span>
        </a>
        
        <div class="header-actions">
            <!-- Mobile Menu Toggle -->
            <div class="menu-toggle" onclick="toggleMenu()" style="display:none; font-size: 1.8rem; cursor: pointer;">
                <i class="ph-bold ph-list"></i>
            </div>

            <button class="theme-btn" onclick="toggleTheme()">
                <i id="theme-icon" class="ph-fill ph-moon"></i>
            </button>

            <nav class="nav-links" id="nav-menu">
                <a href="#about" onclick="toggleMenu()">القصة</a>
                <a href="#gallery" onclick="toggleMenu()">المعرض</a>
                <a href="#positives" onclick="toggleMenu()">المميزات</a>
                <a href="#contact" onclick="toggleMenu()">تواصل معنا</a>
            </nav>

            <button class="btn-header" onclick="document.getElementById('contact').scrollIntoView()">تواصل</button>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-video-container">
            <video id="mainVideo" autoplay muted loop playsinline poster="https://pic.imamhussain.org/photos/hd/1565-9501768055683.jpg">
                <!-- تم تحديث الرابط لاستخدام النطاق المباشر لضمان التشغيل السلس -->
                <source src="https://dl.dropboxusercontent.com/scl/fi/uze5d5wttlcg0bb8uijnf/n.mp4?rlkey=uewgi35fphb9576minim9l5fz&st=rjguly0q" type="video/mp4">
            </video>
        </div>

        <div class="hero-content-block">
            <h1>أرض الحضارة والقداسة</h1>
            <p>منصة رقمية حديثة توثق جمال وعمق النجف الأشرف بعيون معاصرة.</p>
            
            <div class="hero-controls">
                <button class="hero-cta" onclick="document.getElementById('gallery').scrollIntoView()">
                    <i class="ph-fill ph-images-square"></i>
                    <span>شاهد المعرض</span>
                </button>
                <button class="volume-toggle" onclick="toggleSound()">
                    <i id="volIcon" class="ph-fill ph-speaker-slash"></i>
                </button>
            </div>
        </div>
    </section>

    <!-- About -->
    <section id="about">
        <div class="about-grid">
            <div class="about-media">
                <!-- ID assigned for dynamic updates -->
                <img id="about-img" src="https://pic.imamhussain.org/photos/hd/1565-9501768055683.jpg" alt="Najaf">
                
                <!-- Admin Edit Button -->
                <div class="admin-controls" style="top:15px; right:15px; left:auto;">
                    <button class="btn-ctrl btn-edit" onclick="openEditAbout()"><i class="ph-bold ph-pencil"></i></button>
                </div>

                <div class="badge-info">
                    <i class="ph-fill ph-mosque"></i>
                    <div>
                        <strong style="display:block; color:var(--text-main);">1400+ عام</strong>
                        <span style="font-size:0.8rem; color:var(--text-muted);">من التاريخ</span>
                    </div>
                </div>
            </div>
            <div class="about-text">
                <h3>حكاية مدينة لا تشبه غيرها</h3>
                <p>النجف، حيث تمتزج أصالة الماضي بحداثة الحاضر. في أزقتها القديمة تسمع صدى العلماء، وفي شوارعها الجديدة ترى طموح المستقبل. نحن هنا لننقل لك الصورة الأنقى والأجمل لهذه المدينة المقدسة، بعيداً عن الصخب، وقريباً من القلب.</p>
                <div class="tags-container">
                    <span class="tag-pill">#ثقافة</span>
                    <span class="tag-pill">#تاريخ</span>
                    <span class="tag-pill">#عمارة</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Gallery -->
    <section id="gallery" class="bg-alt">
        <div class="section-header">
            <h2>ذاكرة المدينة</h2>
            <p>لقطات مختارة بعناية تبرز الجمال الخفي</p>
        </div>

        <div class="admin-bar">
            <button class="btn-header" onclick="openAddModal('gallery')">
                <i class="ph-bold ph-plus"></i> إضافة صورة
            </button>
        </div>

        <div class="grid-cards" id="gallery-container"></div>
    </section>

    <!-- Features -->
    <section id="positives">
        <div class="section-header">
            <h2>لماذا النجف؟</h2>
            <p>نقاط تجعلها وجهة عالمية فريدة</p>
        </div>

        <div class="admin-bar">
            <button class="btn-header" onclick="openAddModal('positive')">
                <i class="ph-bold ph-plus"></i> إضافة ميزة
            </button>
        </div>

        <div class="grid-cards" id="positives-container"></div>
    </section>

    <!-- Contact -->
    <section id="contact" class="bg-alt">
        <div class="section-header">
            <h2>تواصل معنا</h2>
            <p>نحب سماع قصصكم ومشاركاتكم</p>
        </div>
        <div class="contact-box">
            <form id="contactForm">
                <input type="text" class="input-line" placeholder="الاسم الكريم" required>
                <input type="email" class="input-line" placeholder="البريد الإلكتروني" required>
                <textarea class="input-line" rows="5" placeholder="اكتب رسالتك هنا..." required></textarea>
                <button type="submit" class="btn-header" style="width:100%;">إرسال الرسالة</button>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <p style="margin-bottom: 10px; font-weight: 600;">&copy; 2026 <span>منصة النجف اليوم</span></p>
        
        <!-- Updated Developer Section -->
        <div class="developer-badge">
            <span>تطوير:</span> 
            <a href="https://instagram.com/C4MAN" target="_blank" dir="ltr">ENG. ALI TAOS (@C4MAN)</a>
        </div>

        <div style="margin-top:20px; cursor:pointer; opacity:0.3;" onclick="openAdminLogin()">
            <i class="ph-fill ph-lock-key"></i>
        </div>
    </footer>

    <!-- Modals -->
    <!-- Image Viewer -->
    <div class="modal-overlay" id="img-viewer" onclick="this.classList.remove('active')">
        <div class="modal-content" style="padding:0; overflow:hidden; background:transparent; box-shadow:none; max-width:800px;" onclick="event.stopPropagation()">
            <img id="view-img" src="" style="border-radius:15px;">
            <div style="background:var(--bg-card); padding:20px; margin-top:10px; border-radius:15px;">
                <h3 id="view-title" style="color:var(--primary);"></h3>
                <p id="view-desc" style="color:var(--text-muted);"></p>
            </div>
        </div>
    </div>

    <!-- Admin Login -->
    <div class="modal-overlay" id="admin-modal">
        <div class="modal-content" style="text-align:center;">
            <span style="position:absolute; top:15px; right:20px; cursor:pointer;" onclick="closePopups()">✕</span>
            <h3 style="margin-bottom:20px;">دخول المدير</h3>
            <input type="password" id="admin-pass" class="input-line" placeholder="كلمة المرور">
            <button class="btn-header" onclick="checkAdmin()" style="width:100%;">دخول</button>
        </div>
    </div>

    <!-- Add/Edit Form -->
    <div class="modal-overlay" id="add-modal">
        <div class="modal-content">
            <span style="position:absolute; top:15px; right:20px; cursor:pointer;" onclick="closePopups()">✕</span>
            <h3 id="modal-title" style="margin-bottom:20px; text-align:center;">إضافة جديدة</h3>
            <form id="add-form">
                <div id="text-fields">
                    <input type="text" id="item-title" class="input-line" placeholder="العنوان" required>
                    <input type="text" id="item-desc" class="input-line" placeholder="الوصف" required>
                </div>
                
                <div id="url-group" style="display:none;">
                    <input type="text" id="item-url" class="input-line" placeholder="رابط الصورة (URL)">
                </div>
                <div id="icon-group" style="display:none;">
                    <input type="text" id="item-icon" class="input-line" placeholder="اسم الأيقونة (مثال: ph-star)">
                </div>

                <div id="status-msg" style="text-align:center; color:var(--primary); margin-bottom:10px;"></div>
                <button type="submit" class="btn-header" id="save-btn" style="width:100%;">حفظ</button>
            </form>
        </div>
    </div>

    <!-- JS Logic -->
    <script>
        function toggleTheme() {
            const body = document.body;
            const icon = document.getElementById('theme-icon');
            if(body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                icon.className = 'ph-fill ph-moon';
                localStorage.setItem('theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                icon.className = 'ph-fill ph-sun';
                localStorage.setItem('theme', 'dark');
            }
        }

        window.toggleSound = () => {
            const vid = document.getElementById('mainVideo');
            const icon = document.getElementById('volIcon');
            if(vid.muted) { vid.muted = false; icon.className = "ph-fill ph-speaker-high"; }
            else { vid.muted = true; icon.className = "ph-fill ph-speaker-slash"; }
        };

        window.toggleMenu = () => {
            document.getElementById('nav-menu').classList.toggle('active');
        };

        window.addEventListener('DOMContentLoaded', () => {
            if(localStorage.getItem('theme') === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
                document.getElementById('theme-icon').className = 'ph-fill ph-sun';
            }
        });
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getFirestore, collection, addDoc, deleteDoc, updateDoc, doc, onSnapshot, query, orderBy, writeBatch, setDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "AIzaSyCc05hShE_k2vdFVZ_F1BSKhDHTqR0EL7M", authDomain: "najaftoday.firebaseapp.com",
            projectId: "najaftoday", storageBucket: "najaftoday.firebasestorage.app",
            messagingSenderId: "531725761331", appId: "1:531725761331:web:364e2462317daf325cdc46"
        };
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        window.galleryItems = [];
        window.positiveItems = [];

        async function initAuth() {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) await signInWithCustomToken(auth, __initial_auth_token);
                else await signInAnonymously(auth);
                loadData();
            } catch (error) { console.error(error); }
        }
        initAuth();

        window.renderGallery = () => {
            const container = document.getElementById('gallery-container');
            container.innerHTML = '';
            window.galleryItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'card gallery-card';
                div.innerHTML = `
                    <img src="${item.url}" loading="lazy">
                    <div class="gallery-overlay">
                        <h4>${item.title}</h4>
                        <p>${item.desc.substring(0,60)}...</p>
                    </div>
                    <div class="admin-controls">
                        <button class="btn-ctrl btn-edit" onclick="openEdit('gallery','${item.id}')"><i class="ph-bold ph-pencil"></i></button>
                        <button class="btn-ctrl btn-del" onclick="delItem('gallery','${item.id}')"><i class="ph-bold ph-trash"></i></button>
                    </div>
                `;
                div.onclick = (e) => { if(!e.target.closest('.admin-controls')) openViewer(item.url, item.title, item.desc); };
                container.appendChild(div);
            });
        }

        window.renderPositives = () => {
            const container = document.getElementById('positives-container');
            container.innerHTML = '';
            window.positiveItems.forEach(item => {
                const div = document.createElement('div');
                div.className = 'card feature-card';
                div.innerHTML = `
                    <div class="feature-icon"><i class="ph-fill ${item.icon}"></i></div>
                    <h3>${item.title}</h3>
                    <p style="color:var(--text-muted);">${item.desc}</p>
                    <div class="admin-controls" style="top:auto; bottom:10px; right:10px; left:auto;">
                        <button class="btn-ctrl btn-edit" onclick="openEdit('positives','${item.id}')"><i class="ph-bold ph-pencil"></i></button>
                        <button class="btn-ctrl btn-del" onclick="delItem('positives','${item.id}')"><i class="ph-bold ph-trash"></i></button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function loadData() {
            // Load About Image
            onSnapshot(doc(db, 'artifacts', appId, 'public', 'data', 'sections', 'about'), (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    if (data.imgUrl) document.getElementById('about-img').src = data.imgUrl;
                }
            });

            // Load Gallery
            const qG = query(collection(db, 'artifacts', appId, 'public', 'data', "gallery"));
            onSnapshot(qG, (s) => {
                if(s.empty && !window.seeded) { seedData(); return; }
                window.galleryItems = [];
                s.forEach(d => window.galleryItems.push({id: d.id, ...d.data()}));
                window.galleryItems.sort((a,b) => (b.timestamp||0)-(a.timestamp||0));
                window.renderGallery();
            });
            // Load Positives
            const qP = query(collection(db, 'artifacts', appId, 'public', 'data', "positives"));
            onSnapshot(qP, (s) => {
                window.positiveItems = [];
                s.forEach(d => window.positiveItems.push({id: d.id, ...d.data()}));
                window.positiveItems.sort((a,b) => (b.timestamp||0)-(a.timestamp||0));
                window.renderPositives();
            });
        }

        async function seedData() {
            window.seeded = true;
            const batch = writeBatch(db);
            const g = [
                {id:'gallery_1', title:'قبة الذهب', desc:'مشهد يخطف الأنفاس لقبة الإمام علي (ع).', url:'https://pic.imamhussain.org/photos/hd/1565-9501768055683.jpg', timestamp: Date.now()},
                {id:'gallery_2', title:'التراث', desc:'أزقة النجف القديمة.', url:'https://karbala-intel.net/filestorage/images/62b6a5aea249b.jpg', timestamp: Date.now()-100}
            ];
            const p = [
                {id:'pos_1', title:'كرم لا ينضب', desc:'مدينة المضايف المفتوحة.', icon:'ph-heart', timestamp: Date.now()},
                {id:'pos_2', title:'منارة العلم', desc:'الحوزة العلمية العريقة.', icon:'ph-student', timestamp: Date.now()-100},
                {id:'pos_3', title:'نهضة عمرانية', desc:'مشاريع حديثة.', icon:'ph-buildings', timestamp: Date.now()-200},
                {id:'pos_4', title:'موقع استراتيجي', desc:'بوابة العراق الجوية.', icon:'ph-airplane-tilt', timestamp: Date.now()-300}
            ];
            g.forEach(i => {const{id,...d}=i; batch.set(doc(db,'artifacts',appId,'public','data','gallery',id),d)});
            p.forEach(i => {const{id,...d}=i; batch.set(doc(db,'artifacts',appId,'public','data','positives',id),d)});
            
            // Seed About Image
            batch.set(doc(db,'artifacts',appId,'public','data','sections','about'), {
                imgUrl: "https://pic.imamhussain.org/photos/hd/1565-9501768055683.jpg"
            });

            await batch.commit();
        }

        // --- Admin Functions ---
        window.delItem = async (col, id) => {
            if(confirm('حذف؟')) await deleteDoc(doc(db,'artifacts',appId,'public','data',col,id));
        };

        window.curType = ''; window.curId = null; window.isEdit = false;
        
        window.openAddModal = (type) => {
            window.curType = type; window.isEdit = false; window.curId = null;
            setupForm('إضافة جديدة', 'حفظ', '', '', '', '');
        };

        window.openEdit = (col, id) => {
            window.curType = col === 'gallery' ? 'gallery' : 'positives';
            window.curId = id; window.isEdit = true;
            const list = col === 'gallery' ? window.galleryItems : window.positiveItems;
            const item = list.find(i => i.id === id);
            setupForm('تعديل', 'تعديل', item.title, item.desc, item.url||'', item.icon||'');
        };

        window.openEditAbout = () => {
            window.curType = 'about';
            document.getElementById('add-modal').classList.add('active');
            document.getElementById('modal-title').innerText = 'تعديل صورة القسم';
            document.getElementById('save-btn').innerText = 'حفظ';
            
            document.getElementById('text-fields').style.display = 'none';
            document.getElementById('url-group').style.display = 'block';
            document.getElementById('icon-group').style.display = 'none';
            
            const currentImg = document.getElementById('about-img').src;
            document.getElementById('item-url').value = currentImg;
        };

        function setupForm(title, btnTxt, tVal, dVal, uVal, iVal) {
            document.getElementById('add-modal').classList.add('active');
            document.getElementById('modal-title').innerText = title;
            document.getElementById('save-btn').innerText = btnTxt;
            
            document.getElementById('text-fields').style.display = 'block';
            document.getElementById('item-title').value = tVal;
            document.getElementById('item-desc').value = dVal;
            
            if(window.curType === 'gallery') {
                document.getElementById('url-group').style.display = 'block';
                document.getElementById('icon-group').style.display = 'none';
                document.getElementById('item-url').value = uVal;
            } else {
                document.getElementById('url-group').style.display = 'none';
                document.getElementById('icon-group').style.display = 'block';
                document.getElementById('item-icon').value = iVal;
            }
        }

        window.openAdminLogin = () => document.getElementById('admin-modal').classList.add('active');
        window.closePopups = () => document.querySelectorAll('.modal-overlay').forEach(p => p.classList.remove('active'));
        
        window.checkAdmin = () => {
            if(document.getElementById('admin-pass').value === 'alikuka') {
                document.body.classList.add('is-admin');
                closePopups();
            } else alert('خطأ');
        };

        window.openViewer = (src, t, d) => {
            document.getElementById('view-img').src = src;
            document.getElementById('view-title').innerText = t;
            document.getElementById('view-desc').innerText = d;
            document.getElementById('img-viewer').classList.add('active');
        };

        document.getElementById('add-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('save-btn');
            btn.innerText = '...';
            
            try {
                if (window.curType === 'about') {
                    const url = document.getElementById('item-url').value;
                    await setDoc(doc(db, 'artifacts', appId, 'public', 'data', 'sections', 'about'), { imgUrl: url }, { merge: true });
                } else {
                    const title = document.getElementById('item-title').value;
                    const desc = document.getElementById('item-desc').value;
                    const col = window.curType;
                    const d = {title, desc, timestamp: Date.now()};
                    
                    if(col === 'gallery') d.url = document.getElementById('item-url').value;
                    else d.icon = document.getElementById('item-icon').value || 'ph-star';

                    if(window.isEdit) await updateDoc(doc(db,'artifacts',appId,'public','data',col,window.curId), d);
                    else await addDoc(collection(db,'artifacts',appId,'public','data',col), d);
                }
                closePopups();
            } catch(err) { alert(err.message); }
            btn.innerText = 'حفظ';
        });
    </script>

    <!-- Scroll Effect -->
    <script>
        window.addEventListener('scroll', () => {
            const h = document.getElementById('navbar');
            // No strict change needed for bright theme, kept mostly same
        });
    </script>
</body>
</html>
