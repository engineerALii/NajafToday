<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة النجف اليوم | إشراقة التاريخ</title>
    <meta name="description" content="اكتشف وجه النجف الحضاري والروحي بتصميم عصري.">
    
    <!-- الخطوط: كايرو (هندسي عصري) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- الأيقونات -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        /* ========================================
           1. المتغيرات (Themes)
           ========================================
        */
        :root {
            /* Light Theme (Default) */
            --primary: #1e88e5;
            --primary-dark: #1565c0;
            --accent: #ffb300;
            
            --bg-body: #ffffff;
            --bg-light: #f8f9fa;
            --bg-header: rgba(255, 255, 255, 0.95);
            --bg-card: #ffffff;
            
            --text-main: #2d3436;
            --text-muted: #636e72;
            --text-inverse: #ffffff;
            
            --border-color: #f0f0f0;
            
            --font-main: 'Cairo', sans-serif;
            
            --shadow-card: 0 10px 30px rgba(0,0,0,0.05);
            --shadow-hover: 0 20px 40px rgba(0,0,0,0.1);
            
            --radius: 16px;
        }

        /* Dark Theme Override */
        [data-theme="dark"] {
            --primary: #64b5f6;       /* Lighter blue for dark mode */
            --primary-dark: #42a5f5;
            --accent: #ffca28;
            
            --bg-body: #121212;
            --bg-light: #1e1e1e;
            --bg-header: rgba(18, 18, 18, 0.95);
            --bg-card: #1e1e1e;
            
            --text-main: #e0e0e0;
            --text-muted: #a0a0a0;
            --text-inverse: #121212;
            
            --border-color: #333333;
            
            --shadow-card: 0 10px 30px rgba(0,0,0,0.3);
            --shadow-hover: 0 20px 40px rgba(0,0,0,0.5);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            font-family: var(--font-main);
            overflow-x: hidden;
            line-height: 1.7;
            transition: background-color 0.3s, color 0.3s;
        }

        h1, h2, h3, h4 {
            font-weight: 800;
            color: var(--text-main);
            line-height: 1.3;
        }

        a { text-decoration: none; color: inherit; transition: 0.3s; }
        ul { list-style: none; }
        img { width: 100%; height: auto; display: block; object-fit: cover; }
        button { cursor: pointer; font-family: var(--font-main); }

        /* ========================================
           2. الهيدر (Clean & Sticky)
           ========================================
        */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 15px 5%;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-header);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.03);
            transition: 0.3s;
        }

        .logo {
            font-size: 1.4rem;
            font-weight: 900;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo img {
            width: 40px;
            height: 40px;
            border-radius: 10px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-links a {
            color: var(--text-main);
            font-weight: 600;
            font-size: 1rem;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        /* Language & Theme Controls */
        .lang-select {
            background: var(--bg-light);
            color: var(--text-main);
            border: 1px solid var(--border-color);
            padding: 8px 12px;
            border-radius: 8px;
            font-family: var(--font-main);
            cursor: pointer;
            outline: none;
        }

        .theme-btn {
            background: var(--bg-light);
            color: var(--text-main);
            border: 1px solid var(--border-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: 0.3s;
        }

        .theme-btn:hover {
            background: var(--border-color);
        }

        .btn-header {
            background: var(--primary);
            color: #fff;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.9rem;
            border: none;
            transition: 0.3s;
        }

        .btn-header:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 136, 229, 0.3);
        }

        /* ========================================
           3. الهيرو (Bright & Impactful)
           ========================================
        */
        .hero {
            height: 90vh;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            margin: 10px;
            border-radius: 30px;
            overflow: hidden;
            margin-top: 90px; /* Adjusted for header */
        }

        .hero video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .hero-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, rgba(30, 136, 229, 0.6), rgba(0,0,0,0.3));
        }

        /* Dark mode overlay adjustment */
        [data-theme="dark"] .hero-overlay {
            background: linear-gradient(45deg, rgba(0, 0, 0, 0.7), rgba(0,0,0,0.4));
        }

        .hero-content {
            position: relative;
            z-index: 2;
            color: #fff;
            max-width: 800px;
            padding: 20px;
        }

        .hero-content h1 {
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            color: #fff;
            margin-bottom: 15px;
        }

        .hero-content p {
            font-size: 1.2rem;
            opacity: 0.95;
            margin-bottom: 30px;
            font-weight: 400;
            color: #fff;
        }

        .hero-btn {
            background: #fff;
            color: var(--primary);
            padding: 15px 40px;
            border-radius: 12px;
            font-weight: 800;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: 0.3s;
        }

        .hero-btn:hover {
            background: var(--bg-light);
            transform: scale(1.05);
        }

        /* ========================================
           4. الأقسام (Clean Layout)
           ========================================
        */
        section { padding: 100px 5%; }
        
        .bg-light { background-color: var(--bg-light); }

        .section-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .section-header h2 {
            font-size: 2.5rem;
            color: var(--text-main);
            margin-bottom: 10px;
        }

        .section-header p {
            color: var(--text-muted);
            max-width: 600px;
            margin: 0 auto;
        }

        /* ========================================
           5. عن المدينة (Modern Grid)
           ========================================
        */
        .about-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
        }

        .about-img {
            position: relative;
        }

        .about-img img, 
        .about-img video {
            width: 100%;
            border-radius: 20px;
            box-shadow: var(--shadow-card);
            display: block;
            object-fit: cover;
        }

        .about-badge {
            position: absolute;
            bottom: -20px;
            left: -20px;
            background: var(--bg-card);
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow-hover);
            display: flex;
            align-items: center;
            gap: 15px;
            border: 1px solid var(--border-color);
        }

        .about-badge i {
            font-size: 2rem;
            color: var(--accent);
        }

        .about-text h3 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .about-text p {
            color: var(--text-muted);
            margin-bottom: 20px;
            font-size: 1.05rem;
        }

        /* ========================================
           6. المعرض (Cards)
           ========================================
        */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .gallery-card {
            border-radius: var(--radius);
            overflow: hidden;
            position: relative;
            background: var(--bg-card);
            box-shadow: var(--shadow-card);
            transition: 0.4s;
            cursor: pointer;
            height: 350px;
            border: 1px solid var(--border-color);
        }

        .gallery-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        .gallery-card img {
            width: 100%;
            height: 100%;
            transition: 0.6s;
        }

        .gallery-card:hover img {
            transform: scale(1.05);
        }

        .gallery-info {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 20px;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            color: #fff;
            opacity: 0;
            transition: 0.3s;
            transform: translateY(10px);
        }

        .gallery-card:hover .gallery-info {
            opacity: 1;
            transform: translateY(0);
        }

        .gallery-info h4 { color: #fff; margin-bottom: 5px; }
        .gallery-info p { font-size: 0.9rem; opacity: 0.9; color: #eee; }

        /* ========================================
           7. المميزات (Cards)
           ========================================
        */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 30px;
        }

        .feature-card {
            background: var(--bg-card);
            padding: 40px 30px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-card);
            text-align: center;
            transition: 0.3s;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            border-color: var(--primary);
        }

        .icon-wrapper {
            width: 70px;
            height: 70px;
            background: var(--bg-light);
            color: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 20px;
            transition: 0.3s;
        }

        .feature-card:hover .icon-wrapper {
            background: var(--primary);
            color: #fff;
        }

        .feature-card h3 { color: var(--text-main); }
        .feature-card p { color: var(--text-muted); }

        /* ========================================
           8. تواصل معنا
           ========================================
        */
        .contact-card {
            background: var(--bg-card);
            border-radius: 30px;
            box-shadow: var(--shadow-hover);
            padding: 60px;
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-input {
            width: 100%;
            padding: 15px 20px;
            background: var(--bg-light);
            border: 2px solid transparent;
            border-radius: 12px;
            font-family: var(--font-main);
            transition: 0.3s;
            color: var(--text-main);
        }

        .form-input:focus {
            outline: none;
            background: var(--bg-card);
            border-color: var(--primary);
        }

        textarea.form-input {
            width: 100%;
            margin-bottom: 20px;
        }

        /* ========================================
           9. أدوات التحكم والمودال
           ========================================
        */
        .admin-actions {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 20;
            display: none;
            gap: 8px;
        }

        body.is-admin .admin-actions,
        body.is-admin .admin-add-btn {
            display: flex !important;
        }

        .admin-btn-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: 0.2s;
        }

        .btn-del { background: #ff4757; }
        .btn-del:hover { background: #e84118; transform: scale(1.1); }
        
        .btn-edit { background: #2ed573; }
        .btn-edit:hover { background: #26af61; transform: scale(1.1); }

        .admin-add-btn {
            display: none;
            justify-content: center;
            margin-bottom: 30px;
        }

        .btn-add {
            background: var(--text-main);
            color: var(--text-inverse);
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Modals */
        .modal-wrap {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: none;
            justify-content: center;
            align-items: center;
        }
        
        .modal-wrap.active { display: flex; }

        .modal-box {
            background: var(--bg-card);
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            position: relative;
            box-shadow: var(--shadow-hover);
            color: var(--text-main);
        }

        .close-popup {
            position: absolute;
            top: 15px;
            left: 20px;
            cursor: pointer;
            color: var(--text-main);
            font-size: 1.2rem;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .nav-links { display: none; }
            header { justify-content: space-between; }
            .header-actions { margin-right: auto; }
        }
        @media (max-width: 768px) {
            .hero-content h1 { font-size: 2.5rem; }
            .about-grid, .form-grid { grid-template-columns: 1fr; }
            .contact-card { padding: 30px; }
            .about-badge { left: 0; bottom: -30px; }
        }

        footer {
            background: var(--bg-light);
            color: var(--text-main);
            padding: 40px;
            text-align: center;
            font-size: 0.9rem;
            border-top: 1px solid var(--border-color);
        }
        
        footer a { color: var(--primary); font-weight: bold; }
    </style>
</head>
<body>

    <!-- Header -->
    <header id="navbar">
        <a href="#" class="logo">
            <img src="https://www.dropbox.com/scl/fi/zs0cm1idi65i0nb3oe0m2/IMG_1876.PNG?rlkey=ffq6a5sxyg0m8pd648mchjjdp&st=aogkqr9f&dl=1" alt="Logo">
            <span data-i18n="site_title">النجف اليوم</span>
        </a>
        
        <div class="header-actions">
            <!-- Language Switcher -->
            <select id="lang-switcher" class="lang-select" onchange="changeLanguage(this.value)">
                <option value="ar">العربية</option>
                <option value="en">English</option>
                <option value="fa">فارسی</option>
                <option value="ur">اردو</option>
                <option value="fr">Français</option>
            </select>

            <!-- Theme Toggle -->
            <button class="theme-btn" onclick="toggleTheme()" aria-label="Toggle Theme">
                <i id="theme-icon" class="ph-fill ph-moon"></i>
            </button>

            <!-- Navigation (Desktop) -->
            <nav class="nav-links">
                <a href="#about" data-i18n="nav_story">القصة</a>
                <a href="#gallery" data-i18n="nav_gallery">المعرض</a>
                <a href="#positives" data-i18n="nav_features">المميزات</a>
            </nav>

            <button class="btn-header" onclick="document.getElementById('contact').scrollIntoView()" data-i18n="nav_contact">تواصل معنا</button>
        </div>
    </header>

    <!-- Hero -->
    <section class="hero">
        <video autoplay muted loop playsinline>
            <source src="n.mp4" type="video/mp4">
        </video>
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h1 data-i18n="hero_title">أرض الحضارة والقداسة</h1>
            <p data-i18n="hero_desc">منصة رقمية حديثة توثق جمال وعمق النجف الأشرف بعيون معاصرة.</p>
            <button class="hero-btn" onclick="document.getElementById('gallery').scrollIntoView()">
                <i class="ph-fill ph-play-circle" style="color:var(--primary); font-size:1.5rem;"></i>
                <span data-i18n="hero_btn">شاهد المعرض</span>
            </button>
        </div>
    </section>

    <!-- About -->
    <section id="about">
        <div class="about-grid">
            <div class="about-img">
                <video controls playsinline style="width: 100%; border-radius: 20px; box-shadow: var(--shadow-card);">
                    <source src="n.mp4" type="video/mp4">
                    Your browser does not support video.
                </video>
                <div class="about-badge">
                    <i class="ph-fill ph-mosque"></i>
                    <div>
                        <strong style="display:block; color:var(--text-main);" data-i18n="about_badge_years">1400+ عام</strong>
                        <span style="font-size:0.8rem; color:var(--text-muted);" data-i18n="about_badge_history">من التاريخ</span>
                    </div>
                </div>
            </div>
            <div class="about-text">
                <h3 data-i18n="about_title">حكاية مدينة لا تشبه غيرها</h3>
                <p data-i18n="about_desc">النجف، حيث تمتزج أصالة الماضي بحداثة الحاضر. في أزقتها القديمة تسمع صدى العلماء، وفي شوارعها الجديدة ترى طموح المستقبل. نحن هنا لننقل لك الصورة الأنقى والأجمل لهذه المدينة المقدسة، بعيداً عن الصخب، وقريباً من القلب.</p>
                <div style="margin-top:20px; display:flex; gap:15px;">
                    <span style="background:var(--bg-light); padding:8px 15px; border-radius:50px; font-size:0.9rem; color:var(--primary);" data-i18n="tag_culture">#ثقافة</span>
                    <span style="background:var(--bg-light); padding:8px 15px; border-radius:50px; font-size:0.9rem; color:var(--primary);" data-i18n="tag_history">#تاريخ</span>
                    <span style="background:var(--bg-light); padding:8px 15px; border-radius:50px; font-size:0.9rem; color:var(--primary);" data-i18n="tag_architecture">#عمارة</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Gallery -->
    <section id="gallery" class="bg-light">
        <div class="section-header">
            <h2 data-i18n="gallery_title">ذاكرة المدينة</h2>
            <p data-i18n="gallery_desc">لقطات مختارة بعناية تبرز الجمال الخفي</p>
        </div>

        <div class="admin-add-btn">
            <button class="btn-add" onclick="openAddModal('gallery')">
                <i class="ph-bold ph-plus"></i> إضافة صورة جديدة
            </button>
        </div>

        <div class="gallery-grid" id="gallery-container">
            <!-- Dynamic Content -->
        </div>
    </section>

    <!-- Features -->
    <section id="positives">
        <div class="section-header">
            <h2 data-i18n="features_title">لماذا النجف؟</h2>
            <p data-i18n="features_desc">نقاط تجعلها وجهة عالمية فريدة</p>
        </div>

        <div class="admin-add-btn">
            <button class="btn-add" onclick="openAddModal('positive')">
                <i class="ph-bold ph-plus"></i> إضافة ميزة
            </button>
        </div>

        <div class="features-grid" id="positives-container">
            <!-- Dynamic Content -->
        </div>
    </section>

    <!-- Contact -->
    <section id="contact" class="bg-light">
        <div class="section-header">
            <h2 data-i18n="contact_title">تواصل معنا</h2>
            <p data-i18n="contact_desc">نحب سماع قصصكم ومشاركاتكم</p>
        </div>
        <div class="contact-card">
            <form id="contactForm">
                <div class="form-grid">
                    <input type="text" class="form-input" data-placeholder="contact_name" placeholder="الاسم الكريم" required>
                    <input type="email" class="form-input" data-placeholder="contact_email" placeholder="البريد الإلكتروني" required>
                </div>
                <textarea class="form-input" rows="5" data-placeholder="contact_msg" placeholder="اكتب رسالتك هنا..." required></textarea>
                <button type="submit" class="btn-header" style="width:100%;" data-i18n="contact_btn">إرسال الرسالة</button>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div style="margin-bottom:20px;">
            &copy; 2026 <span data-i18n="site_title">منصة النجف اليوم</span>
        </div>
        <div style="opacity:0.7; font-size:0.85rem;">
            <span data-i18n="footer_dev">تطوير:</span> <a href="https://instagram.com/C4MAN" target="_blank">Eng. Ali Taos (@C4MAN)</a>
        </div>
        <div style="margin-top:20px; cursor:pointer; opacity:0.3;" onclick="openAdminLogin()">
            <i class="ph-fill ph-lock-key"></i>
        </div>
    </footer>

    <!-- Modals -->
    
    <!-- Image Viewer -->
    <div class="modal-wrap" id="img-viewer" onclick="this.classList.remove('active')">
        <div class="modal-box" style="padding:0; overflow:hidden; background:transparent; box-shadow:none;" onclick="event.stopPropagation()">
            <img id="view-img" src="" style="border-radius:20px;">
            <div style="background:var(--bg-card); padding:25px; margin-top:10px; border-radius:20px;">
                <h3 id="view-title" style="color:var(--primary);"></h3>
                <p id="view-desc" style="color:var(--text-muted); margin-top:10px;"></p>
            </div>
        </div>
    </div>

    <!-- Admin Login -->
    <div class="modal-wrap" id="admin-modal">
        <div class="modal-box" style="text-align:center;">
            <span class="close-popup" onclick="closePopups()">✕</span>
            <h3 style="margin-bottom:20px;">لوحة الإدارة</h3>
            <input type="password" id="admin-pass" class="form-input" placeholder="كلمة المرور" style="margin-bottom:20px;">
            <button class="btn-header" onclick="checkAdmin()" style="width:100%;">دخول</button>
        </div>
    </div>

    <!-- Add/Edit Item -->
    <div class="modal-wrap" id="add-modal">
        <div class="modal-box">
            <span class="close-popup" onclick="closePopups()">✕</span>
            <h3 id="modal-title" style="margin-bottom:20px; text-align:center;">إضافة جديدة</h3>
            <form id="add-form">
                <input type="text" id="item-title" class="form-input" placeholder="العنوان" style="margin-bottom:15px;" required>
                <input type="text" id="item-desc" class="form-input" placeholder="الوصف" style="margin-bottom:15px;" required>
                
                <div id="url-group" style="display:none; margin-bottom:15px;">
                    <input type="text" id="item-url" class="form-input" placeholder="رابط الصورة (URL)">
                </div>
                
                <div id="icon-group" style="display:none; margin-bottom:15px;">
                    <input type="text" id="item-icon" class="form-input" placeholder="الأيقونة (مثال: ph-star)">
                </div>

                <div id="status-msg" style="text-align:center; margin-bottom:10px; color:var(--primary); font-weight:bold;"></div>
                <button type="submit" class="btn-header" id="save-btn" style="width:100%;">حفظ</button>
            </form>
        </div>
    </div>

    <!-- Localization & Theme Script -->
    <script>
        // Expanded Translations Dictionary (Including Dynamic seeded content)
        const translations = {
            ar: {
                site_title: "منصة النجف اليوم",
                nav_story: "القصة", nav_gallery: "المعرض", nav_features: "المميزات", nav_contact: "تواصل معنا",
                hero_title: "أرض الحضارة والقداسة",
                hero_desc: "منصة رقمية حديثة توثق جمال وعمق النجف الأشرف بعيون معاصرة.",
                hero_btn: "شاهد المعرض",
                about_badge_years: "1400+ عام", about_badge_history: "من التاريخ",
                about_title: "حكاية مدينة لا تشبه غيرها",
                about_desc: "النجف، حيث تمتزج أصالة الماضي بحداثة الحاضر. في أزقتها القديمة تسمع صدى العلماء، وفي شوارعها الجديدة ترى طموح المستقبل. نحن هنا لننقل لك الصورة الأنقى والأجمل لهذه المدينة المقدسة، بعيداً عن الصخب، وقريباً من القلب.",
                tag_culture: "#ثقافة", tag_history: "#تاريخ", tag_architecture: "#عمارة",
                gallery_title: "ذاكرة المدينة", gallery_desc: "لقطات مختارة بعناية تبرز الجمال الخفي",
                features_title: "لماذا النجف؟", features_desc: "نقاط تجعلها وجهة عالمية فريدة",
                contact_title: "تواصل معنا", contact_desc: "نحب سماع قصصكم ومشاركاتكم",
                contact_name: "الاسم الكريم", contact_email: "البريد الإلكتروني", contact_msg: "اكتب رسالتك هنا...",
                contact_btn: "إرسال الرسالة", footer_dev: "تطوير:",
                // Seeded Content
                gallery_1_title: "قبة الذهب", gallery_1_desc: "مشهد يخطف الأنفاس لقبة الإمام علي (ع).",
                gallery_2_title: "التراث", gallery_2_desc: "أزقة النجف القديمة.",
                pos_1_title: "كرم لا ينضب", pos_1_desc: "مدينة المضايف المفتوحة، تستقبل ملايين الزوار سنويًا بحب وتفانٍ.",
                pos_2_title: "منارة العلم", pos_2_desc: "الحوزة العلمية العريقة، مركز إشعاع فكري يمتد لآلاف السنين.",
                pos_3_title: "نهضة عمرانية", pos_3_desc: "مشاريع حديثة وجسور وطرق ترسم ملامح المستقبل مع الحفاظ على الهوية.",
                pos_4_title: "موقع استراتيجي", pos_4_desc: "بوابة العراق الجوية ومحطة التقاء الحضارات عبر التاريخ."
            },
            en: {
                site_title: "Najaf Today",
                nav_story: "Story", nav_gallery: "Gallery", nav_features: "Features", nav_contact: "Contact Us",
                hero_title: "Land of Holiness",
                hero_desc: "A modern digital platform documenting the beauty and depth of Najaf.",
                hero_btn: "View Gallery",
                about_badge_years: "1400+ Years", about_badge_history: "of History",
                about_title: "A City Like No Other",
                about_desc: "Najaf, where the authenticity of the past blends with the modernity of the present. In its old alleys, you hear the echoes of scholars.",
                tag_culture: "#Culture", tag_history: "#History", tag_architecture: "#Architecture",
                gallery_title: "City Memory", gallery_desc: "Carefully selected shots highlighting hidden beauty",
                features_title: "Why Najaf?", features_desc: "What makes it a unique global destination",
                contact_title: "Contact Us", contact_desc: "We love to hear your stories",
                contact_name: "Your Name", contact_email: "Email Address", contact_msg: "Write your message here...",
                contact_btn: "Send Message", footer_dev: "Developed by:",
                // Seeded Content
                gallery_1_title: "Golden Dome", gallery_1_desc: "A breathtaking view of the dome of Imam Ali (AS).",
                gallery_2_title: "Heritage", gallery_2_desc: "The old alleys of Najaf.",
                pos_1_title: "Boundless Generosity", pos_1_desc: "A city of open guesthouses, welcoming millions annually.",
                pos_2_title: "Beacon of Knowledge", pos_2_desc: "The ancient Hawza, a center of intellectual radiation.",
                pos_3_title: "Urban Renaissance", pos_3_desc: "Modern projects sketching the future.",
                pos_4_title: "Strategic Location", pos_4_desc: "Iraq's aerial gateway and a meeting point of civilizations."
            },
            fa: {
                site_title: "پلتفرم نجف امروز",
                nav_story: "داستان", nav_gallery: "گالری", nav_features: "ویژگی‌ها", nav_contact: "تماس با ما",
                hero_title: "سرزمین تمدن و قداست",
                hero_desc: "پلتفرم دیجیتال مدرن که زیبایی و عمق نجف اشرف را مستند می‌کند.",
                hero_btn: "مشاهده گالری",
                about_badge_years: "+۱۴۰۰ سال", about_badge_history: "از تاریخ",
                about_title: "داستان شهری بی‌همتا",
                about_desc: "نجف، جایی که اصالت گذشته با مدرنیته حال در می‌آمیزد. در کوچه‌های قدیمی‌اش صدای عالمان را می‌شنوید.",
                tag_culture: "#فرهنگ", tag_history: "#تاریخ", tag_architecture: "#معماری",
                gallery_title: "حافظه شهر", gallery_desc: "تصاویری منتخب که زیبایی‌های پنهان را آشکار می‌کند",
                features_title: "چرا نجف؟", features_desc: "ویژگی‌هایی که آن را به مقصدی جهانی تبدیل می‌کند",
                contact_title: "تماس با ما", contact_desc: "ما مشتاق شنیدن داستان‌های شما هستیم",
                contact_name: "نام شما", contact_email: "ایمیل", contact_msg: "پیام خود را بنویسید...",
                contact_btn: "ارسال پیام", footer_dev: "توسعه دهنده:",
                // Seeded Content
                gallery_1_title: "گنبد طلایی", gallery_1_desc: "نمایی خیره کننده از گنبد امام علی (ع).",
                gallery_2_title: "میراث", gallery_2_desc: "کوچه های قدیمی نجف.",
                pos_1_title: "سخاوت بی پایان", pos_1_desc: "شهری با مهمان‌خانه‌های باز که سالانه پذیرای میلیون‌ها نفر است.",
                pos_2_title: "فانوس دانش", pos_2_desc: "حوزه باستانی، کانون تابش فکری.",
                pos_3_title: "رنسانس شهری", pos_3_desc: "پروژه های مدرن که آینده را ترسیم می کنند.",
                pos_4_title: "موقعیت استراتژیک", pos_4_desc: "دروازه هوایی عراق و نقطه تلاقی تمدن ها."
            },
            ur: {
                site_title: "نجف ٹوڈے",
                nav_story: "کہانی", nav_gallery: "گیلری", nav_features: "خصوصیات", nav_contact: "رابطہ کریں",
                hero_title: "تہذیب اور تقدس کی سرزمین",
                hero_desc: "نجف اشرف کی خوبصورتی اور گہرائی کو جدید انداز میں پیش کرنے والا پلیٹ فارم۔",
                hero_btn: "گیلری دیکھیں",
                about_badge_years: "1400+ سال", about_badge_history: "تاریخ کے",
                about_title: "ایک بے مثال شہر",
                about_desc: "نجف، جہاں ماضی کی اصالت حال کی جدت کے ساتھ ملتی ہے۔ اس کی پرانی گلیوں میں آپ کو علماء کی بازگشت سنائی دیتی ہے۔",
                tag_culture: "#ثقافت", tag_history: "#تاریخ", tag_architecture: "#فن_تعمیر",
                gallery_title: "شہر کی یادیں", gallery_desc: "خوبصورتی کو اجاگر کرنے والی منتخب تصاویر",
                features_title: "نجف ہی کیوں؟", features_desc: "وہ باتیں جو اسے منفرد بناتی ہیں",
                contact_title: "رابطہ کریں", contact_desc: "ہم آپ کی کہانیاں سننا چاہتے ہیں",
                contact_name: "آپ کا نام", contact_email: "ای میل", contact_msg: "اپنا پیغام یہاں لکھیں...",
                contact_btn: "پیغام بھیجیں", footer_dev: "ڈویلپر:",
                // Seeded Content
                gallery_1_title: "سنہری گنبد", gallery_1_desc: "امام علی (ع) کے گنبد کا دلکش منظر۔",
                gallery_2_title: "ورثہ", gallery_2_desc: "نجف کی پرانی گلیاں۔",
                pos_1_title: "بے پناہ سخاوت", pos_1_desc: "کھلے مہمان خانوں کا شہر، جو سالانہ لاکھوں لوگوں کا استقبال کرتا ہے۔",
                pos_2_title: "علم کا مینار", pos_2_desc: "قدیم حوزہ، علمی تابکاری کا مرکز۔",
                pos_3_title: "شہری نشاۃ ثانیہ", pos_3_desc: "مستقبل کا خاکہ پیش کرنے والے جدید منصوبے۔",
                pos_4_title: "اسٹریٹجک مقام", pos_4_desc: "عراق کا فضائی دروازہ اور تہذیبوں کا سنگم۔"
            },
            fr: {
                site_title: "Najaf Aujourd'hui",
                nav_story: "Histoire", nav_gallery: "Galerie", nav_features: "Caractéristiques", nav_contact: "Contactez-nous",
                hero_title: "Terre de Civilisation",
                hero_desc: "Une plateforme numérique documentant la beauté et la profondeur de Najaf.",
                hero_btn: "Voir la Galerie",
                about_badge_years: "1400+ Ans", about_badge_history: "d'Histoire",
                about_title: "Une Ville Unique",
                about_desc: "Najaf, où l'authenticité du passé se mêle à la modernité du présent. Dans ses vieilles ruelles, vous entendez l'écho des érudits.",
                tag_culture: "#Culture", tag_history: "#Histoire", tag_architecture: "#Architecture",
                gallery_title: "Mémoire de la Ville", gallery_desc: "Des clichés soigneusement sélectionnés",
                features_title: "Pourquoi Najaf ?", features_desc: "Ce qui en fait une destination mondiale unique",
                contact_title: "Contactez-nous", contact_desc: "Nous aimons entendre vos histoires",
                contact_name: "Votre Nom", contact_email: "Email", contact_msg: "Écrivez votre message ici...",
                contact_btn: "Envoyer", footer_dev: "Développé par :",
                // Seeded Content
                gallery_1_title: "Dôme Doré", gallery_1_desc: "Une vue imprenable sur le dôme de l'Imam Ali (AS).",
                gallery_2_title: "Patrimoine", gallery_2_desc: "Les vieilles ruelles de Najaf.",
                pos_1_title: "Générosité Sans Bornes", pos_1_desc: "Une ville aux maisons d'hôtes ouvertes, accueillant des millions de personnes chaque année.",
                pos_2_title: "Phare du Savoir", pos_2_desc: "L'ancienne Hawza, un centre de rayonnement intellectuel.",
                pos_3_title: "Renaissance Urbaine", pos_3_desc: "Des projets modernes dessinant l'avenir.",
                pos_4_title: "Emplacement Stratégique", pos_4_desc: "La porte aérienne de l'Irak et un point de rencontre des civilisations."
            }
        };

        function changeLanguage(lang) {
            document.documentElement.lang = lang;
            document.documentElement.dir = (lang === 'ar' || lang === 'fa' || lang === 'ur') ? 'rtl' : 'ltr';
            
            const t = translations[lang];
            
            // Text Elements
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (t[key]) el.innerText = t[key];
            });

            // Placeholders
            document.querySelectorAll('[data-placeholder]').forEach(el => {
                const key = el.getAttribute('data-placeholder');
                if (t[key]) el.placeholder = t[key];
            });

            // Trigger re-render of dynamic content
            if (typeof renderGallery === 'function') renderGallery();
            if (typeof renderPositives === 'function') renderPositives();

            localStorage.setItem('lang', lang);
        }

        // Theme Toggle
        function toggleTheme() {
            const body = document.body;
            const icon = document.getElementById('theme-icon');
            
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                icon.className = 'ph-fill ph-moon';
                localStorage.setItem('theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                icon.className = 'ph-fill ph-sun';
                localStorage.setItem('theme', 'dark');
            }
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', () => {
            const savedLang = localStorage.getItem('lang') || 'ar';
            document.getElementById('lang-switcher').value = savedLang;
            changeLanguage(savedLang);

            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
                document.getElementById('theme-icon').className = 'ph-fill ph-sun';
            }
        });
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getFirestore, collection, addDoc, deleteDoc, updateDoc, doc, onSnapshot, query, orderBy, writeBatch, setDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "AIzaSyCc05hShE_k2vdFVZ_F1BSKhDHTqR0EL7M",
            authDomain: "najaftoday.firebaseapp.com",
            projectId: "najaftoday",
            storageBucket: "najaftoday.firebasestorage.app",
            messagingSenderId: "531725761331",
            appId: "1:531725761331:web:364e2462317daf325cdc46"
        };
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        window.galleryItems = [];
        window.positiveItems = [];

        // Auth
        async function initAuth() {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
                loadData();
            } catch (error) { console.error("Auth Error", error); }
        }
        initAuth();

        // Helper to translate dynamic items
        function getTranslatedText(item, field) {
            const lang = document.documentElement.lang || 'ar';
            // Check if there is a translation key like "gallery_1_title"
            const key = `${item.id}_${field}`;
            if (translations[lang] && translations[lang][key]) {
                return translations[lang][key];
            }
            return item[field]; // Fallback to database value
        }

        // Expose render functions to global scope so changeLanguage can call them
        window.renderGallery = function() {
            const container = document.getElementById('gallery-container');
            container.innerHTML = '';
            window.galleryItems.forEach(item => {
                const title = getTranslatedText(item, 'title');
                const desc = getTranslatedText(item, 'desc');
                
                const div = document.createElement('div');
                div.className = 'gallery-card';
                div.innerHTML = `
                    <img src="${item.url}" loading="lazy">
                    <div class="gallery-info">
                        <h4>${title}</h4>
                        <p>${desc.substring(0, 50)}...</p>
                    </div>
                    <div class="admin-actions">
                        <button class="admin-btn-icon btn-edit" onclick="openEditModal('gallery', '${item.id}')"><i class="ph-bold ph-pencil-simple"></i></button>
                        <button class="admin-btn-icon btn-del" onclick="deleteItem('gallery', '${item.id}')"><i class="ph-bold ph-trash"></i></button>
                    </div>
                `;
                div.onclick = (e) => {
                    if(!e.target.closest('.admin-actions')) openViewer(item.url, title, desc);
                };
                container.appendChild(div);
            });
        };

        window.renderPositives = function() {
            const container = document.getElementById('positives-container');
            container.innerHTML = '';
            window.positiveItems.forEach(item => {
                const title = getTranslatedText(item, 'title');
                const desc = getTranslatedText(item, 'desc');

                const div = document.createElement('div');
                div.className = 'feature-card';
                div.innerHTML = `
                    <div class="icon-wrapper"><i class="ph-fill ${item.icon}"></i></div>
                    <h3>${title}</h3>
                    <p style="color:var(--text-muted); margin-top:10px;">${desc}</p>
                    <div class="admin-actions" style="top:auto; bottom:10px; right:10px; left:auto;">
                        <button class="admin-btn-icon btn-edit" onclick="openEditModal('positive', '${item.id}')"><i class="ph-bold ph-pencil-simple"></i></button>
                        <button class="admin-btn-icon btn-del" onclick="deleteItem('positives', '${item.id}')"><i class="ph-bold ph-trash"></i></button>
                    </div>
                `;
                container.appendChild(div);
            });
        };

        function loadData() {
            const qGallery = query(collection(db, 'artifacts', appId, 'public', 'data', "gallery"));
            onSnapshot(qGallery, (snapshot) => {
                if (snapshot.empty && !window.gallerySeeded) { seedData(); return; }
                window.galleryItems = [];
                snapshot.forEach(doc => {
                    window.galleryItems.push({id: doc.id, ...doc.data()});
                });
                // Sort
                window.galleryItems.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
                renderGallery();
            });

            const qPositives = query(collection(db, 'artifacts', appId, 'public', 'data', "positives"));
            onSnapshot(qPositives, (snapshot) => {
                window.positiveItems = [];
                snapshot.forEach(doc => {
                    window.positiveItems.push({id: doc.id, ...doc.data()});
                });
                window.positiveItems.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
                renderPositives();
            });
        }

        async function seedData() {
            window.gallerySeeded = true;
            const batch = writeBatch(db);
            
            // Use fixed IDs for seeding to map translations
            const initialGallery = [
                {id: 'gallery_1', title: "قبة الذهب", desc: "مشهد يخطف الأنفاس لقبة الإمام علي (ع).", url: "https://pic.imamhussain.org/photos/hd/1565-9501768055683.jpg", timestamp: Date.now()},
                {id: 'gallery_2', title: "التراث", desc: "أزقة النجف القديمة.", url: "https://karbala-intel.net/filestorage/images/62b6a5aea249b.jpg", timestamp: Date.now()-100}
            ];
            const initialPositives = [
                {id: 'pos_1', title: "كرم لا ينضب", desc: "مدينة المضايف المفتوحة، تستقبل ملايين الزوار سنويًا بحب وتفانٍ.", icon: "ph-heart", timestamp: Date.now() },
                {id: 'pos_2', title: "منارة العلم", desc: "الحوزة العلمية العريقة، مركز إشعاع فكري يمتد لآلاف السنين.", icon: "ph-student", timestamp: Date.now() - 100 },
                {id: 'pos_3', title: "نهضة عمرانية", desc: "مشاريع حديثة وجسور وطرق ترسم ملامح المستقبل مع الحفاظ على الهوية.", icon: "ph-buildings", timestamp: Date.now() - 200 },
                {id: 'pos_4', title: "موقع استراتيجي", desc: "بوابة العراق الجوية ومحطة التقاء الحضارات عبر التاريخ.", icon: "ph-airplane-tilt", timestamp: Date.now() - 300 }
            ];

            initialGallery.forEach(item => {
                const {id, ...data} = item;
                batch.set(doc(db, 'artifacts', appId, 'public', 'data', 'gallery', id), data);
            });
            
            initialPositives.forEach(item => {
                const {id, ...data} = item;
                batch.set(doc(db, 'artifacts', appId, 'public', 'data', 'positives', id), data);
            });

            await batch.commit();
        }

        // Global Window Functions
        window.deleteItem = async (col, id) => {
            if(confirm('حذف هذا العنصر؟')) {
                await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', col, id));
            }
        };

        window.currentType = '';
        window.currentId = null;
        window.isEditing = false;

        window.openAddModal = (type) => {
            window.currentType = type;
            window.isEditing = false;
            window.currentId = null;
            document.getElementById('add-modal').classList.add('active');
            document.getElementById('modal-title').innerText = 'إضافة جديدة';
            document.getElementById('add-form').reset();
            document.getElementById('save-btn').innerText = 'حفظ';
            toggleFields(type);
        };

        window.openEditModal = (type, id) => {
            window.currentType = type;
            window.currentId = id;
            window.isEditing = true;
            
            let item = type === 'gallery' ? window.galleryItems.find(i => i.id === id) : window.positiveItems.find(i => i.id === id);
            if(!item) return;

            document.getElementById('add-modal').classList.add('active');
            document.getElementById('modal-title').innerText = 'تعديل المحتوى';
            document.getElementById('save-btn').innerText = 'تعديل';
            
            document.getElementById('item-title').value = item.title;
            document.getElementById('item-desc').value = item.desc;
            
            toggleFields(type);
            
            if(type === 'gallery') document.getElementById('item-url').value = item.url;
            else document.getElementById('item-icon').value = item.icon;
        };

        function toggleFields(type) {
            if(type === 'gallery') {
                document.getElementById('url-group').style.display = 'block';
                document.getElementById('icon-group').style.display = 'none';
            } else {
                document.getElementById('url-group').style.display = 'none';
                document.getElementById('icon-group').style.display = 'block';
            }
        }

        window.openAdminLogin = () => document.getElementById('admin-modal').classList.add('active');
        window.closePopups = () => document.querySelectorAll('.modal-wrap').forEach(p => p.classList.remove('active'));
        
        window.checkAdmin = () => {
            if(document.getElementById('admin-pass').value === 'alikuka') {
                document.body.classList.add('is-admin');
                closePopups();
                alert('مرحباً بك، أيها المدير');
            } else {
                alert('كلمة المرور خاطئة');
            }
        };

        window.openViewer = (src, title, desc) => {
            document.getElementById('view-img').src = src;
            document.getElementById('view-title').innerText = title;
            document.getElementById('view-desc').innerText = desc;
            document.getElementById('img-viewer').classList.add('active');
        };

        // Form Submit
        document.getElementById('add-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = document.getElementById('save-btn');
            const status = document.getElementById('status-msg');
            btn.disabled = true;
            btn.innerText = '...';

            const title = document.getElementById('item-title').value;
            const desc = document.getElementById('item-desc').value;

            try {
                const colName = window.currentType === 'gallery' ? 'gallery' : 'positives';
                const data = { title, desc, timestamp: Date.now() };
                
                if(window.currentType === 'gallery') {
                    const url = document.getElementById('item-url').value;
                    if(!url) throw new Error('يرجى إدخال رابط الصورة');
                    data.url = url;
                } else {
                    const icon = document.getElementById('item-icon').value || 'ph-star';
                    data.icon = icon;
                }

                if(window.isEditing) {
                    status.innerText = 'جاري التعديل...';
                    await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', colName, window.currentId), data);
                } else {
                    status.innerText = 'جاري الحفظ...';
                    await addDoc(collection(db, 'artifacts', appId, 'public', 'data', colName), data);
                }
                
                closePopups();
                document.getElementById('add-form').reset();
            } catch(err) {
                alert(err.message);
            } finally {
                btn.disabled = false;
                btn.innerText = window.isEditing ? 'تعديل' : 'حفظ';
                status.innerText = '';
            }
        });
    </script>

    <!-- Scroll Effect -->
    <script>
        window.addEventListener('scroll', () => {
            const h = document.getElementById('navbar');
            // No strict change needed for bright theme, kept mostly same
        });
    </script>
</body>
</html>
